<!DOCTYPE html>
<html lang ="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Outfit Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gradient-to-b from-cyan-300 via-cyan-800 to-black min-h-screen flex flex-col items-center justify-center">
    <h1 class="text-4xl md:text-5xl font-semibold text-white mb-20 px-4">Weather Outfit Predictor...</h1>
    <div class="bg-beige w-full max-w-xl p-8 rounded-2xl shadow-lg text-center bg-amber-100">

        <p class="text-lg text-black mb-6">Click the button below to predict the best outfit based on your current weather conditions</p>
        <button onclick="getLocationAndRecommend()" id="predictButton"
                class="bg-white text-black px-6 py-2 rounded-lg shadow-md hover:bg-gray-100 transition duration-300">
            Predict Outfit  
        </button>
        <div id="result" class="mt-6 text-lg text-gray-800"></div>
    </div>
    <script>
        function getLocationAndRecommend() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;


                        try{
                            const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&hourly=relative_humidity_2m,precipitation`
                            );
                            const data = await response.json();
                            const response1 = await fetch("/predict",{
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json"},
                                    body: JSON.stringify({
                                        temperature: data.current_weather.temperature,
                                        humidity:data.hourly.relative_humidity_2m[0],
                                        wind_speed: data.current_weather.windspeed,
                                        precipitation: data.hourly.precipitation[0]
                                    })

                            });
                           console.log({
  temperature: data.current_weather.temperature,
  humidity: data.hourly.relative_humidity_2m[0],
  wind_speed: data.current_weather.windspeed,
  precipitation: data.hourly.precipitation[0]
});
                            const prediction = await response1.json();
                            
                            document.getElementById("result").innerHTML =
                                `Recommended Outfit: <span class="text-red-600 font-semibold">${prediction.recommended_outfit}</span>`;
                        } catch (error) {
                            document.getElementById("result").innerText = 
                                `Error fetching weather data: ${error.message}`;
                        }
                    },
                    (error) => {
                        document.getElementById("result").innerText = 
                            "Location access denied or unavailable";
                    }
                );
            }else{
                document.getElementById("result").innerText = 
                    "Geolocation is not supported by this browser.";
            }
        }
    </script>
</body>
</html>
            